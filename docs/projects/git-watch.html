<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>git-watch</title><link rel="stylesheet" href="/site.css"></head><body><div class="container"><header style="padding:1rem;border-bottom:1px solid #ddd"><nav>&middot; &nbsp;<a href="/">home</a> &middot;&nbsp<a href="/projects/">projects</a> &middot;&nbsp<a href="/tags.html">tags</a> &middot;&nbsp<a href="/archive.html">archive</a> &middot;&nbsp</nav></header><main class="article"><div class="grid-container"><div class="grid-box">&raquo; <a href="/">sigmonsays</a> / <a href="/projects">projects</a> &nbsp;</div><div class="grid-box" style="text-align: right;">Posted on 2021/08/04 &nbsp; <br>tagged <a href="/tag/projects.html">projects</a> &nbsp;</div></div><p></p><h1>git-watch</h1><p>git watch is a simple library and CLI tool for monitoring git repositories and triggering events (restart process) when they change.</p>
<p>git watch [1] was designed as a way to easily build and deploy daemons in development when upstream changes. The changes can be either
code (in git) or configuration.</p>
<p>So here is a simple example which will automatically rebuild and restart a application when you git push (<a href="https://github.com/sigmonsays/git-watch/tree/master/examples/go">https://github.com/sigmonsays/git-watch/tree/master/examples/go</a>)</p>
<p>Below in git-watch.yaml we check the upstream every 5 seconds and merge the master branch in. execcmd is &quot;my_application&quot; which is a simple application. When a upstream
change is detected, we invoke the updatecmd. If the updatecmd does not succeed, the restart process is aborted. Assuming the update command succeeds, we then invoke the install
command. After the install command succeeds, the application is restarted.</p>
<p>git-watch.yaml</p>
<pre><code>  # reinstall a go application when changes are detected in a git remote
  checkinterval: 5
  localbranch: master
  execcmd: my_application
  updatecmd: make
  install: make install
</code></pre>
<p>Makefile</p>
<pre><code>  REPO=github.com/sigmonsays/git-watch

  all:
     go get -u $(REPO)/examples/go/my_application/...

  install:
     go install $(REPO)/examples/go/my_application
</code></pre>
<p>Full usage</p>
<pre><code>Usage of git-watch:
 -branch string
       local branch (default &quot;master&quot;)
 -check int
       git check interval (seconds) (default 5)
 -config string
       git watch config (default &quot;git-watch.yaml&quot;)
 -dir string
       change directory before starting (default &quot;.&quot;)
 -exec-cmd string
       exec command (default &quot;make run&quot;)
 -http string
       start a http server
 -inherit-env
       inherit environment
 -inotify-dir string
       use inotify as a trigger in directory
 -install-cmd string
       install command (default &quot;make install&quot;)
 -loglevel string
       set log level (default &quot;error&quot;)
 -once
       run once and exit
 -static-dir string
       static directory (default &quot;static&quot;)
 -update-cmd string
       update command (default &quot;make&quot;)
</code></pre>
<ul>
<li>[1] - <a href="https://github.com/sigmonsays/git-watch">https://github.com/sigmonsays/git-watch</a></li>
</ul>
</main><footer style="padding:1rem;border-top:1px solid #ddd;margin-top:2rem"><small>Â© Sigmonsays 2014</small></footer></div></body></html>